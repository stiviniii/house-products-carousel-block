/**
 * House Products Carousel — Frontend Styles
 *
 * BEM naming, mobile-first, modern card design.
 * GeneratePress compatible — no framework conflicts.
 */

// ─── Variables ──────────────────────────────────────
$hpc-primary: #1a1a2e;
// $hpc-accent: #e94560;
$hpc-accent: var(--wp--preset--color--accent);
$hpc-accent-light: #ff6b81;
$hpc-bg: #f8f9fc;
$hpc-card-bg: var(--base-3, #ffffff);
$hpc-text: #2d3436;
$hpc-text-light: #636e72;
$hpc-border: #eef0f4;
$hpc-shadow: 0 4px 24px rgba(0, 0, 0, 0.06);
$hpc-shadow-hover: 0 12px 40px rgba(0, 0, 0, 0.12);
$hpc-radius: .375rem;
$hpc-rating-color: #f9a825;
$hpc-transition: 0.35s cubic-bezier(0.4, 0, 0.2, 1);

// ─── Carousel Wrapper ───────────────────────────────
.hpc-carousel-wrapper {
	position: relative;
	padding: 1rem 0;
	width: 100%;
	// overflow: hidden;
}

// ─── Splide Overrides ───────────────────────────────
.hpc-carousel {

	&.splide {
		padding: 0.5rem 0;
	}

	.splide__arrows {
		position: absolute;
		top: 50%;
		transform: translateY(-50%);
		z-index: 10;
		inset-inline: 10px;
		pointer-events: none;
		display: flex;
		justify-content: space-between;
	}

	.splide__track {
		overflow: hidden;

		.hpc-carousel-wrapper.hpc-track-overflow-visible & {
			overflow: visible;
		}
	}

	.splide__list {
		list-style: none;
		margin: 0;
		padding: 0;
	}

	.splide__slide {
		padding: 0 0.25rem;

		// Setup reveal animation when enabled
		.hpc-animate-reveal & {
			opacity: 0;
			transform: translateX(30px);
			transition: opacity var(--hpc-anim-duration, 800ms) cubic-bezier(0.25, 1, 0.5, 1),
				transform var(--hpc-anim-duration, 800ms) cubic-bezier(0.25, 1, 0.5, 1);
			transition-delay: var(--reveal-delay, 0ms);
		}

		// Reveal slides when the wrapper enters the viewport
		.is-revealed & {
			opacity: 1 !important;
			transform: translateX(0) !important;
		}

		// Generate staggered delays based on the stagger variable
		@for $i from 1 through 12 {
			&:nth-child(#{$i}) {
				--reveal-delay: calc(#{$i} * var(--hpc-anim-stagger, 150ms));
			}
		}
	}

	// Nav arrows
	.splide__arrow {
		width: 44px;
		height: 44px;
		padding: 0;
		background: $hpc-card-bg;
		border: 1px solid $hpc-border;
		border-radius: 50%;
		opacity: 1;
		transition: all $hpc-transition;
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		pointer-events: auto;

		svg {
			width: 20px;
			height: 20px;
			fill: $hpc-primary;
			// Ensure it's perfectly centered
			display: block;
		}

		&:hover,
		&:focus-visible {
			background: $hpc-primary;
			border-color: $hpc-primary;
			box-shadow: $hpc-shadow-hover;
			outline: none;

			svg {
				fill: #fff;
			}
		}

		&:focus-visible {
			outline: 2px solid $hpc-accent;
			outline-offset: 2px;
		}

		&--prev {

			svg {
				transform: rotate(180deg);
			}
		}

		&--next {}

		&:disabled {
			opacity: 0;
			pointer-events: none;
		}
	}
}

// ─── Product Card ───────────────────────────────────
.hpc-card {
	position: relative;
	overflow: hidden;
	border-radius: $hpc-radius;
	background-color: $hpc-card-bg;
	height: 100%;

	// ─── Card Link ──────────────────────────────────
	&__link {
		display: flex;
		flex-direction: column;
		height: 100%;
		text-decoration: none;
		color: inherit;

		&:hover,
		&:focus {
			text-decoration: none;
			color: inherit;
		}

		&:focus-visible {
			outline: 2px solid $hpc-accent;
			outline-offset: -2px;
			border-radius: $hpc-radius;
		}
	}

	// ─── Image ──────────────────────────────────────
	&__image-wrapper {
		position: relative;
		width: 100%;
		aspect-ratio: 3 / 2;
		overflow: hidden;
		background: linear-gradient(135deg, #f0f0f0 0%, #e8e8e8 100%);
	}

	&__image {
		width: 100%;
		height: 100%;
		object-fit: cover;
		transition: opacity 0.5s ease-in-out, transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);

		&--featured {
			position: relative;
			z-index: 1;
		}

		&--hover {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			opacity: 0;
			visibility: hidden;
			z-index: 2;
			transition: opacity 0.5s ease-in-out, transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
		}

		&--placeholder {
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 0.85rem;
			color: $hpc-text-light;
			background: linear-gradient(135deg, #f5f5f5 0%, #ececec 100%);
		}

		.hpc-card:hover &--hover {
			opacity: 1;
			visibility: visible;
			transform: scale(1.02);
		}
	}

	// ─── Badge ──────────────────────────────────────
	&__badge {
		position: absolute;
		top: 12px;
		left: 12px;
		padding: 5px 12px;
		background: $hpc-accent;
		color: #fff;
		font-size: 0.7rem;
		font-weight: 700;
		text-transform: uppercase;
		letter-spacing: 0.06em;
		border-radius: 6px;
		z-index: 2;
		box-shadow: 0 2px 8px rgba($hpc-accent, 0.35);
		animation: hpc-badge-pulse 2s ease-in-out infinite;
	}

	// ─── Body ───────────────────────────────────────
	&__body {
		padding: 1rem 1.25rem 0.75rem;
		flex: 1;
	}

	&__title {
		margin: 0 0 0.5rem;
		font-size: 1rem;
		font-weight: 600;
		line-height: 1.35;
		color: $hpc-text;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
		transition: color $hpc-transition;

		.hpc-card:hover & {
			color: $hpc-accent;
		}
	}

	&__price {
		font-size: 1.15rem;
		font-weight: 700;
		color: $hpc-primary;
		margin-bottom: 0.5rem;

		del {
			color: $hpc-text-light;
			font-weight: 400;
			font-size: 0.85rem;
			margin-right: 0.35rem;
		}

		ins {
			text-decoration: none;
			color: $hpc-accent;
		}
	}

	// ─── Rating ─────────────────────────────────────
	&__rating {
		display: flex;
		align-items: center;
		gap: 0.25rem;
		margin-bottom: 0.25rem;
	}

	&__rating-count {
		font-size: 0.75rem;
		color: $hpc-text-light;
		margin-left: 0.15rem;
	}

	// ─── Specs Row ──────────────────────────────────
	&__specs {
		display: grid;
		grid-template-columns: repeat(3, 1fr);
		grid-template-rows: repeat(2, 1fr);
		gap: 0;
		padding: 0.85rem 1.25rem;
	}

	&__spec {
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		gap: 0.8rem;
		font-size: 0.875rem;
		color: $hpc-text-light;
		padding: 0.15rem 0;
		min-width: fit-content;
		justify-content: center;

		&:not(:nth-child(3n)) {
			border-right: 1px solid $hpc-border;
			padding-right: 0.6rem;
			margin-right: 0.6rem;
		}
	}

	&__spec-icon {
		display: flex;
		align-items: center;
		color: $hpc-accent;
		flex-shrink: 0;

		svg {
			width: 22px;
			height: auto;
		}
	}

	&__spec-value {
		font-weight: 600;
		color: $hpc-text;
		white-space: nowrap;
	}
}

// ─── Stars ──────────────────────────────────────────
.hpc-star {
	color: $hpc-rating-color;
	vertical-align: middle;

	&--empty {
		color: #ddd;
	}
}

// ─── No Products ────────────────────────────────────
.hpc-no-products {
	padding: 2rem;
	text-align: center;
	color: $hpc-text-light;
	font-size: 0.95rem;
}

// ─── Animations ─────────────────────────────────────
@keyframes hpc-badge-pulse {

	0%,
	100% {
		box-shadow: 0 2px 8px rgba($hpc-accent, 0.35);
	}

	50% {
		box-shadow: 0 4px 16px rgba($hpc-accent, 0.55);
	}
}

// ─── Reduced Motion ─────────────────────────────────
@media (prefers-reduced-motion: reduce) {
	.hpc-carousel .splide__slide {
		transition: none !important;
		opacity: 1 !important;
		transform: none !important;
		transition-delay: 0ms !important;
	}

	.hpc-card {
		transition: none;

		&__image {
			transition: none;
		}

		&__title {
			transition: none;
		}

		&__badge {
			animation: none;
		}
	}

	.hpc-carousel .splide__arrow {
		transition: none;
	}
}

// ─── Responsive ─────────────────────────────────────
@media (max-width: 768px) {
	.hpc-carousel {
		.splide__arrow {
			width: 36px;
			height: 36px;

			&--prev {
				left: -8px;
			}

			&--next {
				right: -8px;
			}
		}
	}

	.hpc-card {
		&__body {
			padding: 0.85rem 1rem 0.65rem;
		}

		&__title {
			font-size: 0.9rem;
		}

		&__price {
			font-size: 1rem;
		}

		&__specs {
			padding: 0.65rem 1rem;
		}

		&__spec {
			font-size: 0.7rem;
		}
	}
}

@media (max-width: 480px) {
	.hpc-carousel {
		.splide__arrow {
			width: 32px;
			height: 32px;

			svg {
				width: 14px;
				height: 14px;
			}

			&--prev {
				left: 4px;
			}

			&--next {
				right: 4px;
			}
		}
	}

	.hpc-card {
		&__specs {
			flex-wrap: wrap;
			gap: 0.25rem;
		}

		&__spec {
			flex: 0 0 auto;

			&:not(:last-child) {
				border-right: none;
				padding-right: 0;
				margin-right: 0;

				&::after {
					content: "·";
					margin-left: 0.4rem;
					color: $hpc-text-light;
				}
			}
		}
	}
}